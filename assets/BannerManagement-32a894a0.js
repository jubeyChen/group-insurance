import{d as oe,J as N,r as D,ac as ie,y as ce,g as de,a5 as j,o as h,c as v,a as e,b as u,u as o,h as r,t as x,w as m,i as T,p as A,k as f,n as R,F as re,j as ue,e as O,v as V,s as he,x as me,_ as _e}from"./index-039f4073.js";import{_ as pe}from"./icon_note-96b9c260.js";import{u as ve,D as xe,_ as fe,a as be,b as ge,c as z,d as ke}from"./DraggableTable-1ef0d209.js";import{_ as we}from"./icon_search_white-67c4c154.js";import{_ as U}from"./icon_outcome-1d2e6907.js";import{I as g}from"./createPageStore-69190bd9.js";import{u as Ce,_ as Se}from"./BannerForm.vue_vue_type_script_setup_true_lang-c11c2188.js";import{_ as P}from"./InputDate.vue_vue_type_style_index_0_lang-1e3be0af.js";import{N as S}from"./Checkbox-2c7dea10.js";import{T as ye}from"./Table-40d47b03.js";import{D as Be}from"./vuedraggable.umd-89278f99.js";import"./icon_upload-consent-letter-8322da82.js";import"./FormTitle.vue_vue_type_script_setup_true_lang-31e68bf9.js";import"./moment-fbc5633a.js";import"./vue.runtime.esm-bundler-8ba684d5.js";const i=y=>(he("data-v-5a66c4c4"),y=y(),me(),y),De={class:"text-neutral-800"},Te=i(()=>e("div",{class:"max-w-[1315px] mx-auto mb-12"},[e("h1",{class:"text-[32px]"}," Banner管理 ")],-1)),Ie={class:"max-w-[1315px] mx-auto mb-8"},Ae={class:"search mb-10"},Ee=i(()=>e("h2",{class:"flex items-center mb-6 font-semibold"},[e("img",{class:"mr-2",src:pe,alt:"Search Page"}),r(" 搜尋網頁 ")],-1)),$e={class:"rounded-[16px] overflow-hidden border border-[#B9B9B9]"},Fe=i(()=>e("h3",{class:"text-sm font-bold text-primary-600 bg-[#E6EDF3] py-4 px-6 border border-b-[#80B7DE]"}," 請輸入搜尋條件(擇一) ",-1)),Me={class:"bg-white flex flex-col max-[1065px]:flex-row px-[24px] pb-[20px] pt-[120px]"},Ne={class:"flex flex-col absolute top-[270px]"},je=i(()=>e("label",{class:"mb-[10px]"}," 發佈時間 ",-1)),Re={class:"flex"},Oe=i(()=>e("div",{class:"flex items-center justify-center px-[10px] ml-[55px]"}," - ",-1)),Ve={class:"flex items-center max-[1065px]:flex-col max-[1065px]:items-start"},Pe=i(()=>e("p",{class:"flex items-center mr-4 max-[1065px]:mb-[5px] max-[1065px]:mt-[3px]"},[e("img",{class:"mr-2",src:fe,alt:"Status"}),r(" 狀態 ")],-1)),ze={class:"flex max-[1065px]:flex-col max-[1065px]:mb-[20px] max-[1065px]:gap-1"},Ue={class:"ml-1 mr-5 max-[1065px]:ml-0"},We={for:"published",class:"flex items-center"},Le={class:"mr-5"},He={for:"pending",class:"flex items-center"},Qe={class:"mr-5"},qe={class:"flex items-center"},Ge={class:"mr-5"},Je={class:"flex items-center"},Ye={class:"flex items-center"},Ke={class:"ml-auto flex gap-3"},Xe=i(()=>e("img",{class:"mr-4",src:we,alt:"Search"},null,-1)),Ze={class:"search mb-10"},et={class:"search-outcome flex items-center justify-between mb-8"},tt=i(()=>e("h2",{class:"flex items-center font-semibold"},[e("img",{class:"mr-2",src:U,alt:"Query"}),r(" 查詢結果 ")],-1)),st=i(()=>e("img",{class:"mr-2",src:be,alt:"Add"},null,-1)),at=i(()=>e("caption",null,"Banner Management Table",-1)),nt=i(()=>e("th",{class:"flex ml-3 justify-start w-[35%]"}," Banner 題目 ",-1)),lt=i(()=>e("th",{class:"w-[12%]"}," 狀態 ",-1)),ot=i(()=>e("th",{class:"w-[15%]"}," 發佈時間 ",-1)),it={key:0,class:"grow"},ct={class:"w-[35%]","data-title":"Banner 題目："},dt={class:"flex items-center pl-3 max-[1065px]:pl-3"},rt={class:"w-[12%]","data-title":"狀態："},ut={class:"flex items-center pl-3 max-[1065px]:pl-3"},ht={src:ge,alt:"Waiting For Release"},mt={src:z,alt:"Announcing"},_t={class:"ml-2"},pt={class:"w-[15%]","data-title":"發佈時間："},vt={class:"max-[1065px]:pl-3"},xt={class:"grid grid-cols-3 max-[1065px]:pl-3"},ft=["onClick"],bt=["onClick"],gt=["onClick"],kt=["onClick"],wt={key:0,class:"grow","data-title":"審核："},Ct={class:"flex gap-[10px] justify-center"},St=i(()=>e("div",{class:"search-outcome flex items-center justify-between mb-8"},[e("h2",{class:"flex items-center font-semibold"},[e("img",{class:"mr-2",src:U,alt:"Arrangement"}),r(" 排列順序 ")])],-1)),yt=i(()=>e("th",{class:"flex ml-3 justify-start w-[35%]"}," Banner 題目 ",-1)),Bt=i(()=>e("th",{class:"w-[12%]"}," 狀態 ",-1)),Dt=i(()=>e("th",{class:"w-[15%]"}," 發佈時間 ",-1)),Tt=i(()=>e("th",{class:"grow"}," 編號 ",-1)),It={class:"tr list-group-item text-center text-sm text-black"},At={class:"w-[35%] max-[1065px]:ml-7","data-title":"Banner 題目："},Et={class:"flex items-center max-[1065px]:pl-3"},$t=i(()=>e("img",{class:"mr-5 max-[1065px]:hidden",src:ke,alt:"Catch"},null,-1)),Ft={class:"w-[12%] max-[1065px]:ml-7","data-title":"狀態："},Mt={class:"flex items-center pl-3 max-[1065px]:pl-3"},Nt=i(()=>e("img",{src:z,alt:"Check"},null,-1)),jt={class:"ml-2"},Rt={class:"w-[15%] max-[1065px]:ml-7","data-title":"發佈時間："},Ot={class:"max-[1065px]:pl-3"},Vt={class:"max-[1065px]:ml-7","data-title":"操作："},Pt={class:"max-[1065px]:pl-3"},zt=oe({__name:"BannerManagement",setup(y){const W=Ce(),{bannerManagementInfo:_,filterBannerData:b,permissionStatus:p,filterSelectDate:d,checkBoxState:s,sortOrderData:L}=N(W),E=D(L.value),I=D(""),B=D("backAdd"),k=D(!1),H=ie();ce(()=>H.path);function Q(){p.value==="review"?(s.value.discontinued.isChecked=!0,s.value.pending.isChecked=!0,s.value.published.isChecked=!0,s.value.reviewing.isChecked=!0,s.value.reviewFailed.isChecked=!0,p.value=""):(s.value.discontinued.isChecked=!1,s.value.pending.isChecked=!1,s.value.published.isChecked=!1,s.value.reviewing.isChecked=!0,s.value.reviewFailed.isChecked=!1,p.value="review")}de(()=>{s.value.discontinued.isChecked=!0,s.value.pending.isChecked=!0,s.value.published.isChecked=!0,s.value.reviewing.isChecked=!0,s.value.reviewFailed.isChecked=!0,b.value=_.value});const q=()=>{const n=Object.keys(s.value).some(l=>s.value[l].isChecked),a=d.value.searchStartTime!="",t=d.value.searchEndTime!="";if(n)n&&a&&t?b.value=_.value.filter(l=>{const c=new Date(l.publishStartAt),C=(!d.value.searchStartTime||c>=new Date(d.value.searchStartTime))&&(!d.value.searchEndTime||c<=new Date(d.value.searchEndTime));return Object.keys(s.value).some(le=>{const M=s.value[le];return M.isChecked&&l.status===M.value&&C})}):b.value=_.value.filter(l=>Object.keys(s.value).some(c=>{const C=s.value[c];return C.isChecked&&l.status===C.value}));else if(a&&t)b.value=_.value.filter(l=>{const c=new Date(l.publishStartAt);return(!d.value.searchStartTime||c>=new Date(d.value.searchStartTime))&&(!d.value.searchEndTime||c<=new Date(d.value.searchEndTime))});else if(a||t)alert("請選擇發佈起始時間和截止時間");else return b.value=[]};function G(n){console.log("startPublishStartAt:"),console.log(n);const t=new Date(n).toISOString().split("T")[0];d.value.searchStartTime=t,console.log(d.value.searchStartTime)}function J(n){console.log("endPublishStartAt:"),console.log(n);const a=new Date(n);a.setHours(23,59,59,999);const t=a.toISOString().split("T")[0];d.value.searchEndTime=t,console.log(d.value.searchEndTime)}function w(n){s.value[n].isChecked=!s.value[n].isChecked}function $(n){const a=new Date(n),t=a.getFullYear(),l=(a.getMonth()+1).toString().padStart(2,"0"),c=a.getDate().toString().padStart(2,"0");return`${t}/${l}/${c}`}function Y(){B.value="backAdd",k.value=!0}function K(n){const a=_.value.findIndex(t=>t.bannerId===n);console.log(a),a!==-1&&_.value.splice(a,1)}function X(n){B.value="backQuery",I.value=n,k.value=!0}function Z(n){B.value="backEdit",I.value=n,k.value=!0}function ee(n){n.status=g.Suspended}function te(){k.value=!1}function se(n,a){switch(console.log("獲得了"),console.log(n),console.log(a),a){case"backAdd":_.value.push(n);break;case"backEdit":const t=_.value.findIndex(l=>l.bannerId===n.bannerId);if(t!==-1){const l=n;l.publishStartAt=$(l.publishStartAt),l.publishEndAt=$(l.publishEndAt),l.status=g.InReview,_.value[t]=l}break}}const ae=ve(),{breadcrumbs:ne}=N(ae);ne.value=[{title:"資料",path:j.DATA_MAINTENANCE},{title:"Banner",path:j.BANNER}];function F(n,a){n.status=a}return(n,a)=>(h(),v("section",De,[Te,e("div",Ie,[e("div",Ae,[Ee,e("div",$e,[Fe,e("div",Me,[e("div",Ne,[je,e("div",Re,[u(P,{placeholder:"請選擇日期",class:"date-picker-input","onUpdate:modelValue":G}),Oe,u(P,{placeholder:"請選擇日期",class:"date-picker-input","onUpdate:modelValue":J})])]),e("div",Ve,[Pe,e("ul",ze,[e("li",Ue,[e("label",We,[u(S,{id:"published",name:"state","model-value":o(s).published.isChecked,"is-checked":o(s).published.isChecked,onChange:a[0]||(a[0]=t=>w("published"))},null,8,["model-value","is-checked"]),r(" 發佈中 ")])]),e("li",Le,[e("label",He,[u(S,{id:"pending",name:"state","model-value":o(s).pending.isChecked,"is-checked":o(s).pending.isChecked,onChange:a[1]||(a[1]=t=>w("pending"))},null,8,["model-value","is-checked"]),r(" 等待發佈 ")])]),e("li",Qe,[e("label",qe,[u(S,{id:"discontinued",name:"state","model-value":o(s).discontinued.isChecked,"is-checked":o(s).discontinued.isChecked,onChange:a[2]||(a[2]=t=>w("discontinued"))},null,8,["model-value","is-checked"]),r(" 下架 ")])]),e("li",Ge,[e("label",Je,[u(S,{id:"4",name:"reviewing","model-value":o(s).reviewing.isChecked,"is-checked":o(s).reviewing.isChecked,onChange:a[3]||(a[3]=t=>w("reviewing"))},null,8,["model-value","is-checked"]),r(" 審核中 ")])]),e("li",null,[e("label",Ye,[u(S,{id:"reviewFailed",name:"state","model-value":o(s).reviewFailed.isChecked,"is-checked":o(s).reviewFailed.isChecked,onChange:a[4]||(a[4]=t=>w("reviewFailed"))},null,8,["model-value","is-checked"]),r(" 審核失敗 ")])])]),e("div",Ke,[e("button",{class:"bg-danger hover:bg-[#ba3e3e] text-[white] px-4 p-2 rounded-md ml-3 max-[1065px]:ml-0 text-sm",onClick:Q},x(o(p)==="review"?"長官身份: 切換完請按搜尋":"員工身份: 切換完請按搜尋"),1),u(T,{class:"flex items-center justify-center font-semibold text-base pe-2",size:"custom",width:130,height:40,onClick:q},{default:m(()=>[Xe,r(" 搜尋 ")]),_:1})])])])])]),e("div",Ze,[e("div",et,[tt,u(T,{class:"flex items-center justify-center font-semibold text-base",size:"custom",width:140,height:40,onClick:Y},{default:m(()=>[st,r(" 新增 Banner ")]),_:1})]),u(ye,null,{th:m(()=>[nt,lt,ot,e("th",{class:R(o(p)==="review"?"w-[18%]":"grow")}," 操作 ",2),o(p)==="review"?(h(),v("th",it," 審核 ")):f("",!0)]),tobodyTr:m(()=>[(h(!0),v(re,null,ue(o(b),(t,l)=>(h(),v("tr",{key:l,class:"text-center text-sm text-black"},[e("td",ct,[e("div",dt,[e("span",null,x(t.bannerName),1)])]),e("td",rt,[e("div",ut,[O(e("img",ht,null,512),[[V,t.status!=="發佈中"&&t.status!=="等待發佈"]]),O(e("img",mt,null,512),[[V,t.status==="發佈中"||t.status==="等待發佈"]]),e("span",_t,x(t.status),1)])]),e("td",pt,[e("span",vt,x(t.publishStartAt),1)]),e("td",{class:R(o(p)==="review"?"w-[18%]":"grow"),"data-title":"操作："},[e("div",xt,[e("a",{class:"text-[#1170C0] underline cursor-pointer",onClick:c=>X(t.bannerId)}," 查看內容 ",8,ft),t.status==="下架"||t.status==="審核失敗"||t.status==="審核中"||t.status==="等待發佈"?(h(),v("a",{key:0,class:"text-[#1170C0] underline cursor-pointer",onClick:c=>Z(t.bannerId)}," 編輯 ",8,bt)):f("",!0),t.status==="發佈中"?(h(),v("a",{key:1,class:"text-[#1170C0] underline cursor-pointer",onClick:c=>ee(t)}," 下架 ",8,gt)):f("",!0),t.status!=="發佈中"&&t.status!=="等待發佈"&&t.status!=="審核中"?(h(),v("a",{key:2,class:"text-[#1170C0] underline cursor-pointer",onClick:c=>K(t.bannerId)}," 刪除 ",8,kt)):f("",!0)])],2),o(p)==="review"?(h(),v("td",wt,[e("div",Ct,[t.status===o(g).InReview?(h(),A(T,{key:0,size:"custom",width:70,height:40,onClick:c=>F(t,o(g).Published)},{default:m(()=>[r(" 通過 ")]),_:2},1032,["onClick"])):f("",!0),t.status===o(g).InReview?(h(),A(T,{key:1,class:"deny-button text-white font-bold py-2 px-4 rounded",size:"custom",width:70,height:40,onClick:c=>F(t,o(g).Failure)},{default:m(()=>[r(" 駁回 ")]),_:2},1032,["onClick"])):f("",!0)])])):f("",!0)]))),128))]),default:m(()=>[at]),_:1})]),e("div",null,[St,u(xe,null,{th:m(()=>[yt,Bt,Dt,Tt]),tobodyTr:m(()=>[u(o(Be),{modelValue:E.value,"onUpdate:modelValue":a[5]||(a[5]=t=>E.value=t),group:"sortOrderDataDisplay","drag-class":"drag","ghost-class":"ghost","item-key":"id",tag:"tbody","component-data":{tag:"tr",name:"flip-list",type:"transition"}},{item:m(({element:t,index:l})=>[e("tr",It,[e("td",At,[e("div",Et,[$t,e("span",null,x(t.bannerName),1)])]),e("td",Ft,[e("div",Mt,[Nt,e("span",jt,x(t.status),1)])]),e("td",Rt,[e("div",Ot,x(t.publishStartAt),1)]),e("td",Vt,[e("div",Pt,x(l+1)+". ",1)])])]),_:1},8,["modelValue"])]),_:1})])]),k.value?(h(),A(Se,{key:0,"banner-type":B.value,"edit-id":I.value,onClose:te,onAddOrEditBanner:se},null,8,["banner-type","edit-id"])):f("",!0)]))}});const as=_e(zt,[["__scopeId","data-v-5a66c4c4"]]);export{as as default};
