import{d as ie,J as j,r as D,ac as ne,y as ce,g as de,a5 as N,o as h,c as v,a as e,b as u,u as i,h as r,t as x,w as m,i as T,p as E,k as f,n as O,F as re,j as ue,e as R,v as V,s as he,x as me,_ as _e}from"./index-039f4073.js";import{_ as pe}from"./icon_note-96b9c260.js";import{u as ve,D as xe,_ as fe,a as ge,b as be,c as z,d as ke}from"./DraggableTable-1ef0d209.js";import{_ as we}from"./icon_search_white-67c4c154.js";import{_ as U}from"./icon_outcome-1d2e6907.js";import{I as b}from"./createPageStore-69190bd9.js";import{u as Ce,A as Se}from"./AddEidtADForm-9127ba46.js";import{_ as P}from"./InputDate.vue_vue_type_style_index_0_lang-1e3be0af.js";import{N as S}from"./Checkbox-2c7dea10.js";import{T as Ae}from"./Table-40d47b03.js";import{D as ye}from"./vuedraggable.umd-89278f99.js";import"./icon_upload-consent-letter-8322da82.js";import"./FormTitle.vue_vue_type_script_setup_true_lang-31e68bf9.js";import"./moment-fbc5633a.js";import"./vue.runtime.esm-bundler-8ba684d5.js";const n=A=>(he("data-v-f7b0d385"),A=A(),me(),A),De={class:"text-neutral-800"},Te=n(()=>e("div",{class:"max-w-[1315px] mx-auto mb-12"},[e("h1",{class:"text-[32px]"}," 廣告管理 ")],-1)),Ie={class:"max-w-[1315px] mx-auto mb-8"},Ee={class:"search mb-10"},$e=n(()=>e("h2",{class:"flex items-center mb-6 font-semibold"},[e("img",{class:"mr-2",src:pe,alt:"Search Page"}),r(" 搜尋網頁 ")],-1)),Fe={class:"rounded-[16px] overflow-hidden border border-[#B9B9B9]"},Be=n(()=>e("h3",{class:"text-sm font-bold text-primary-600 bg-[#E6EDF3] py-4 px-6 border border-b-[#80B7DE]"}," 請輸入搜尋條件(擇一) ",-1)),Me={class:"bg-white flex flex-col max-[1065px]:flex-row px-[24px] pb-[20px] pt-[120px]"},je={class:"flex flex-col absolute top-[270px]"},Ne=n(()=>e("label",{class:"mb-[10px]"}," 發佈時間 ",-1)),Oe={class:"flex"},Re=n(()=>e("div",{class:"flex items-center justify-center px-[10px] ml-[55px]"}," - ",-1)),Ve={class:"flex items-center max-[1065px]:flex-col max-[1065px]:items-start"},Pe=n(()=>e("p",{class:"flex items-center mr-4 max-[1065px]:mb-[5px] max-[1065px]:mt-[3px]"},[e("img",{class:"mr-2",src:fe,alt:"Status"}),r(" 狀態 ")],-1)),ze={class:"flex max-[1065px]:flex-col max-[1065px]:mb-[20px] max-[1065px]:gap-1"},Ue={class:"ml-1 mr-5 max-[1065px]:ml-0"},We={for:"published",class:"flex items-center"},Le={class:"mr-5"},He={for:"pending",class:"flex items-center"},Qe={class:"mr-5"},qe={class:"flex items-center"},Ge={class:"mr-5"},Je={class:"flex items-center"},Ye={class:"flex items-center"},Ke={class:"ml-auto flex gap-3"},Xe=n(()=>e("img",{class:"mr-4",src:we,alt:"Search"},null,-1)),Ze={class:"search mb-10"},et={class:"search-outcome flex items-center justify-between mb-8"},tt=n(()=>e("h2",{class:"flex items-center font-semibold"},[e("img",{class:"mr-2",src:U,alt:"Query"}),r(" 查詢結果 ")],-1)),st=n(()=>e("img",{class:"mr-2",src:ge,alt:"Add"},null,-1)),at=n(()=>e("caption",null,"AD Management Table",-1)),lt=n(()=>e("th",{class:"flex ml-3 justify-start w-[35%]"}," 廣告名稱 ",-1)),ot=n(()=>e("th",{class:"w-[12%]"}," 狀態 ",-1)),it=n(()=>e("th",{class:"w-[15%]"}," 發佈時間 ",-1)),nt={key:0,class:"grow"},ct={class:"w-[35%]","data-title":"廣告名稱："},dt={class:"flex items-center pl-3 max-[1065px]:pl-3"},rt={class:"w-[12%]","data-title":"狀態："},ut={class:"flex items-center pl-3 max-[1065px]:pl-3"},ht={src:be,alt:"Waiting For Release"},mt={src:z,alt:"Announcing"},_t={class:"ml-2"},pt={class:"w-[15%]","data-title":"發佈時間："},vt={class:"max-[1065px]:pl-3"},xt={class:"grid grid-cols-3 max-[1065px]:pl-3"},ft=["onClick"],gt=["onClick"],bt=["onClick"],kt=["onClick"],wt={key:0,class:"grow","data-title":"審核："},Ct={class:"flex gap-[10px] justify-center"},St=n(()=>e("div",{class:"search-outcome flex items-center justify-between mb-8"},[e("h2",{class:"flex items-center font-semibold"},[e("img",{class:"mr-2",src:U,alt:"Arrangement"}),r(" 排列順序 ")])],-1)),At=n(()=>e("th",{class:"flex pl-3 justify-start w-[35%]"}," 廣告名稱 ",-1)),yt=n(()=>e("th",{class:"w-[12%]"}," 狀態 ",-1)),Dt=n(()=>e("th",{class:"w-[15%]"}," 發佈時間 ",-1)),Tt=n(()=>e("th",{class:"grow"}," 編號 ",-1)),It={class:"tr list-group-item text-center text-sm text-black"},Et={class:"w-[35%] max-[1065px]:ml-7","data-title":"廣告名稱："},$t={class:"flex items-center max-[1065px]:pl-3"},Ft=n(()=>e("img",{class:"mr-5 max-[1065px]:hidden",src:ke,alt:"Catch"},null,-1)),Bt={class:"w-[12%] max-[1065px]:ml-7","data-title":"狀態："},Mt={class:"flex items-center pl-3 max-[1065px]:pl-3"},jt=n(()=>e("img",{src:z,alt:"Check"},null,-1)),Nt={class:"ml-2"},Ot={class:"w-[15%] max-[1065px]:ml-7","data-title":"發佈時間："},Rt={class:"max-[1065px]:pl-3"},Vt={class:"max-[1065px]:ml-7","data-title":"操作："},Pt={class:"max-[1065px]:pl-3"},zt=ie({__name:"AdManagement",setup(A){const W=Ce(),{adManagementInfo:_,filterAdData:g,permissionStatus:p,filterSelectDate:d,checkBoxState:s,sortOrderAdData:L}=j(W),$=D(L.value),I=D(""),y=D("backAdd"),k=D(!1),H=ne();ce(()=>H.path);function Q(){p.value==="review"?(s.value.discontinued.isChecked=!0,s.value.pending.isChecked=!0,s.value.published.isChecked=!0,s.value.reviewing.isChecked=!0,s.value.reviewFailed.isChecked=!0,p.value=""):(s.value.discontinued.isChecked=!1,s.value.pending.isChecked=!1,s.value.published.isChecked=!1,s.value.reviewing.isChecked=!0,s.value.reviewFailed.isChecked=!1,p.value="review")}de(()=>{s.value.discontinued.isChecked=!0,s.value.pending.isChecked=!0,s.value.published.isChecked=!0,s.value.reviewing.isChecked=!0,s.value.reviewFailed.isChecked=!0,g.value=_.value});const q=()=>{const l=Object.keys(s.value).some(o=>s.value[o].isChecked),a=d.value.searchStartTime!="",t=d.value.searchEndTime!="";if(l)l&&a&&t?g.value=_.value.filter(o=>{const c=new Date(o.publishStartAt),C=(!d.value.searchStartTime||c>=new Date(d.value.searchStartTime))&&(!d.value.searchEndTime||c<=new Date(d.value.searchEndTime));return Object.keys(s.value).some(oe=>{const M=s.value[oe];return M.isChecked&&o.status===M.value&&C})}):g.value=_.value.filter(o=>Object.keys(s.value).some(c=>{const C=s.value[c];return C.isChecked&&o.status===C.value}));else if(a&&t)g.value=_.value.filter(o=>{const c=new Date(o.publishStartAt);return(!d.value.searchStartTime||c>=new Date(d.value.searchStartTime))&&(!d.value.searchEndTime||c<=new Date(d.value.searchEndTime))});else if(a||t)alert("請選擇發佈起始時間和截止時間");else return g.value=[]};function G(l){console.log("startPublishStartAt:"),console.log(l);const t=new Date(l).toISOString().split("T")[0];d.value.searchStartTime=t,console.log(d.value.searchStartTime)}function J(l){console.log("endPublishStartAt:"),console.log(l);const a=new Date(l);a.setHours(23,59,59,999);const t=a.toISOString().split("T")[0];d.value.searchEndTime=t,console.log(d.value.searchEndTime)}function w(l){s.value[l].isChecked=!s.value[l].isChecked}function F(l){const a=new Date(l),t=a.getFullYear(),o=(a.getMonth()+1).toString().padStart(2,"0"),c=a.getDate().toString().padStart(2,"0");return`${t}/${o}/${c}`}function Y(){y.value="backAdd",k.value=!0}function K(l){const a=_.value.findIndex(t=>t.adId===l);console.log(a),a!==-1&&_.value.splice(a,1)}function X(l){console.log(l),y.value="backQuery",I.value=l,k.value=!0}function Z(l){console.log(l),y.value="backEdit",I.value=l,k.value=!0}function ee(l){l.status=b.Suspended}function te(){k.value=!1}function se(l,a){switch(console.log("獲得了"),console.log(l),console.log(a),a){case"backAdd":_.value.push(l);break;case"backEdit":const t=_.value.findIndex(o=>o.adId===l.adId);if(t!==-1){const o=l;o.publishStartAt=F(o.publishStartAt),o.publishEndAt=F(o.publishEndAt),o.status=b.InReview,_.value[t]=o}break}}const ae=ve(),{breadcrumbs:le}=j(ae);le.value=[{title:"資料",path:N.DATA_MAINTENANCE},{title:"Ad",path:N.AD}];function B(l,a){l.status=a}return(l,a)=>(h(),v("section",De,[Te,e("div",Ie,[e("div",Ee,[$e,e("div",Fe,[Be,e("div",Me,[e("div",je,[Ne,e("div",Oe,[u(P,{placeholder:"請選擇日期",class:"date-picker-input","onUpdate:modelValue":G}),Re,u(P,{placeholder:"請選擇日期",class:"date-picker-input","onUpdate:modelValue":J})])]),e("div",Ve,[Pe,e("ul",ze,[e("li",Ue,[e("label",We,[u(S,{id:"published",name:"state","model-value":i(s).published.isChecked,"is-checked":i(s).published.isChecked,onChange:a[0]||(a[0]=t=>w("published"))},null,8,["model-value","is-checked"]),r(" 發佈中 ")])]),e("li",Le,[e("label",He,[u(S,{id:"pending",name:"state","model-value":i(s).pending.isChecked,"is-checked":i(s).pending.isChecked,onChange:a[1]||(a[1]=t=>w("pending"))},null,8,["model-value","is-checked"]),r(" 等待發佈 ")])]),e("li",Qe,[e("label",qe,[u(S,{id:"discontinued",name:"state","model-value":i(s).discontinued.isChecked,"is-checked":i(s).discontinued.isChecked,onChange:a[2]||(a[2]=t=>w("discontinued"))},null,8,["model-value","is-checked"]),r(" 下架 ")])]),e("li",Ge,[e("label",Je,[u(S,{id:"4",name:"reviewing","model-value":i(s).reviewing.isChecked,"is-checked":i(s).reviewing.isChecked,onChange:a[3]||(a[3]=t=>w("reviewing"))},null,8,["model-value","is-checked"]),r(" 審核中 ")])]),e("li",null,[e("label",Ye,[u(S,{id:"reviewFailed",name:"state","model-value":i(s).reviewFailed.isChecked,"is-checked":i(s).reviewFailed.isChecked,onChange:a[4]||(a[4]=t=>w("reviewFailed"))},null,8,["model-value","is-checked"]),r(" 審核失敗 ")])])]),e("div",Ke,[e("button",{class:"bg-danger hover:bg-[#ba3e3e] text-[white] px-4 p-2 rounded-md ml-3 max-[1065px]:ml-0 text-sm",onClick:Q},x(i(p)==="review"?"長官身份: 切換完請按搜尋":"員工身份: 切換完請按搜尋"),1),u(T,{class:"flex items-center justify-center font-semibold text-base pe-2",size:"custom",width:130,height:40,onClick:q},{default:m(()=>[Xe,r(" 搜尋 ")]),_:1})])])])])]),e("div",Ze,[e("div",et,[tt,u(T,{class:"flex items-center justify-center font-semibold text-base",size:"custom",width:140,height:40,onClick:Y},{default:m(()=>[st,r(" 新增 AD ")]),_:1})]),u(Ae,null,{th:m(()=>[lt,ot,it,e("th",{class:O(i(p)==="review"?"w-[18%]":"grow")}," 操作 ",2),i(p)==="review"?(h(),v("th",nt," 審核 ")):f("",!0)]),tobodyTr:m(()=>[(h(!0),v(re,null,ue(i(g),(t,o)=>(h(),v("tr",{key:o,class:"text-center text-sm text-black"},[e("td",ct,[e("div",dt,[e("span",null,x(t.adName),1)])]),e("td",rt,[e("div",ut,[R(e("img",ht,null,512),[[V,t.status!=="發佈中"&&t.status!=="等待發佈"]]),R(e("img",mt,null,512),[[V,t.status==="發佈中"||t.status==="等待發佈"]]),e("span",_t,x(t.status),1)])]),e("td",pt,[e("span",vt,x(t.publishStartAt),1)]),e("td",{class:O(i(p)==="review"?"w-[18%]":"grow"),"data-title":"操作："},[e("div",xt,[e("a",{class:"text-[#1170C0] underline cursor-pointer",onClick:c=>X(t.adId)}," 查看內容 ",8,ft),t.status==="下架"||t.status==="審核失敗"||t.status==="審核中"||t.status==="等待發佈"?(h(),v("a",{key:0,class:"text-[#1170C0] underline cursor-pointer",onClick:c=>Z(t.adId)}," 編輯 ",8,gt)):f("",!0),t.status==="發佈中"?(h(),v("a",{key:1,class:"text-[#1170C0] underline cursor-pointer",onClick:c=>ee(t)}," 下架 ",8,bt)):f("",!0),t.status!=="發佈中"&&t.status!=="等待發佈"&&t.status!=="審核中"?(h(),v("a",{key:2,class:"text-[#1170C0] underline cursor-pointer",onClick:c=>K(t.adId)}," 刪除 ",8,kt)):f("",!0)])],2),i(p)==="review"?(h(),v("td",wt,[e("div",Ct,[t.status===i(b).InReview?(h(),E(T,{key:0,size:"custom",width:70,height:40,onClick:c=>B(t,i(b).Published)},{default:m(()=>[r(" 通過 ")]),_:2},1032,["onClick"])):f("",!0),t.status===i(b).InReview?(h(),E(T,{key:1,class:"deny-button text-white font-bold py-2 px-4 rounded",size:"custom",width:70,height:40,onClick:c=>B(t,i(b).Failure)},{default:m(()=>[r(" 駁回 ")]),_:2},1032,["onClick"])):f("",!0)])])):f("",!0)]))),128))]),default:m(()=>[at]),_:1})]),e("div",null,[St,u(xe,null,{th:m(()=>[At,yt,Dt,Tt]),tobodyTr:m(()=>[u(i(ye),{modelValue:$.value,"onUpdate:modelValue":a[5]||(a[5]=t=>$.value=t),group:"sortOrderAdDataDisplay","drag-class":"drag","ghost-class":"ghost","item-key":"id",tag:"tbody","component-data":{tag:"tr",name:"flip-list",type:"transition"}},{item:m(({element:t,index:o})=>[e("tr",It,[e("td",Et,[e("div",$t,[Ft,e("span",null,x(t.adName),1)])]),e("td",Bt,[e("div",Mt,[jt,e("span",Nt,x(t.status),1)])]),e("td",Ot,[e("div",Rt,x(t.publishStartAt),1)]),e("td",Vt,[e("div",Pt,x(o+1)+". ",1)])])]),_:1},8,["modelValue"])]),_:1})])]),k.value?(h(),E(Se,{key:0,"ad-type":y.value,"edit-id":I.value,onClose:te,onAddOrEditAd:se},null,8,["ad-type","edit-id"])):f("",!0)]))}});const as=_e(zt,[["__scopeId","data-v-f7b0d385"]]);export{as as default};
