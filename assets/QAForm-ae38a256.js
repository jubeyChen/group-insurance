import{a3 as K,r as b,y as X,d as Z,J as j,W as ee,g as ae,o as te,p as le,b as d,w as m,T as se,a9 as ie,a,u as x,a2 as ne,l as S,m as w,L as N,t as _,n as H,e as y,v as I,i as M,h as P,a4 as O,s as oe,x as de,_ as re}from"./index-72eb97a3.js";import{_ as ue}from"./icon_upload-consent-letter-8322da82.js";import{_ as ce}from"./FormTitle.vue_vue_type_script_setup_true_lang-3ddf6d71.js";/* empty css                                                               */import{_ as U}from"./InputDate.vue_vue_type_style_index_0_lang-16a23bdb.js";import{I as r,u as pe}from"./createPageStore-5e2e62fe.js";const me=K("qaQuery",()=>{const q=b("revie"),u=b({searchStartTime:"",searchEndTime:""}),c=b([{qaId:"",qaTitle:"",qaContent:"",status:"",publishStartAt:"",publishEndAt:"",qaFile:{},qaImage:{},qaHyperlink:"",isDefault:!0}]),C=b([{qaId:"2023/08/17 12:53:44",qaTitle:"Q1. 事故發生後該怎麼？到那裡申請理賠？",qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",status:r.Published,publishStartAt:"2023/08/17",publishEndAt:"2023/09/17",qaFile:"example1.pdf",qaImage:"example1.image",qaHyperlink:"url.example1.com",isDefault:!0},{qaId:"2023/08/21 09:53:14",qaTitle:"Q2. 事故發生後該怎麼？到那裡申請理賠？",qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",status:r.InReview,publishStartAt:"2023/08/21",publishEndAt:"2023/08/28",qaFile:"example2.pdf",qaImage:"example2.image",qaHyperlink:"url.example2.com",isDefault:!0},{qaId:"2023/08/20 05:24:12",qaTitle:"Q3. 事故發生後該怎麼？到那裡申請理賠？",qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",status:r.InReview,publishStartAt:"2023/08/20",publishEndAt:"2023/09/07",qaFile:"example3.pdf",qaImage:"example3.image",qaHyperlink:"url.example3.com",isDefault:!0},{qaId:"2023/09/20 09:11:22",qaTitle:"Q4. 事故發生後該怎麼？到那裡申請理賠？",qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",status:r.Awaiting,publishStartAt:"2023/11/29",publishEndAt:"2023/12/30",qaFile:"example4.pdf",qaImage:"example4.image",qaHyperlink:"url.example4.com",isDefault:!0},{qaId:"2023/09/20 10:22:44",qaTitle:"Q5. 如何聯絡專員",status:r.Suspended,qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",publishStartAt:"2023/09/20",publishEndAt:"2023/10/10",qaFile:"example5.pdf",qaImage:"example5.image",qaHyperlink:"url.example5.com",isDefault:!0},{qaId:"2023/11/11 11:11:11",qaTitle:"Q6. 如何聯絡專員",status:r.InReview,qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",publishStartAt:"2023/11/11",publishEndAt:"2023/12/11",qaFile:"example6.pdf",qaImage:"example6.image",qaHyperlink:"url.example6.com",isDefault:!0},{qaId:"2023/10/10 10:10:10",qaTitle:"Q7. 如何聯絡專員",status:r.Failure,qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",publishStartAt:"2023/10/10",publishEndAt:"2023/11/11",qaFile:"example7.pdf",qaImage:"example7.image",qaHyperlink:"url.example7.com",isDefault:!0},{qaId:"2023/08/18 12:53:33",qaTitle:"Q8. 事故發生後該怎麼？到那裡申請理賠？",qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",status:r.Published,publishStartAt:"2023/08/18",publishEndAt:"2023/09/18",qaFile:"example8.pdf",qaImage:"example8.image",qaHyperlink:"url.example8.com",isDefault:!0},{qaId:"2023/08/19 11:59:59",qaTitle:"Q9. 事故發生後該怎麼？到那裡申請理賠？",qaContent:"備妥相關文件（請參考理賠應備文件） · 列印並填妥理賠申請書。",status:r.Published,publishStartAt:"2023/08/19",publishEndAt:"2023/09/19",qaFile:"example9.pdf",qaImage:"example9.image",qaHyperlink:"url.example9.com",isDefault:!0}]),h=X(()=>C.value.filter(E=>E.status===r.Published)),T=b({published:{isChecked:!1,value:"發佈中"},pending:{isChecked:!1,value:"等待發佈"},discontinued:{isChecked:!1,value:"下架"},reviewing:{isChecked:!1,value:"審核中"},reviewFailed:{isChecked:!1,value:"審核失敗"}});return{permissionStatus:q,qaManagementInfo:C,sortOrderData:h,checkBoxState:T,filterQAManagementInfo:c,filterSelectDate:u}}),f=q=>(oe("data-v-43194a0d"),q=q(),de(),q),be={class:"modal-mask QA-form"},fe={class:"content"},ve={class:"content-box"},qe={class:"py-6"},he={class:"w-[80%] mx-auto px-[10px]"},ge={class:"flex flex-col mb-8"},xe=f(()=>a("label",{class:"text-base text-primary-600 w-[130px] mb-2 block",for:"publishStartAt"},"發佈時間",-1)),_e={class:"input-date flex row align-middle relative"},ye=f(()=>a("div",{class:"flex items-center px-[10px] ml-[55px]"}," - ",-1)),Ie={class:"mb-8"},ke=f(()=>a("label",{class:"text-base text-primary-600 w-[130px] mb-2 inline-block"},"問題",-1)),Ae={class:"mb-8"},Se=f(()=>a("label",{class:"text-base text-primary-600 w-[130px] mb-2 inline-block"},"回答",-1)),we=["disabled","model-value","error-message"],Ce={class:"text-[theme('colors.danger')] text-sm"},Ee={class:"mb-8"},Fe=f(()=>a("p",{class:"text-base text-primary-600 w-[130px] mb-2 inline-block"}," 上傳檔案 ",-1)),Qe={class:"flex justify-around border-b border-b-primary-400 text-neutral-800 mb-4"},Te={class:"h-[240px] outline-1 outline-dashed rounded-md outline-neutral-400 flex items-center justify-center text-neutral-800"},De=["id"],$e=f(()=>a("img",{src:ue,alt:"file-upload",class:"mb-2"},null,-1)),He=f(()=>a("p",{class:"text-lg"}," 請上傳檔案 ",-1)),Me={class:"text-sm text-black/50"},Pe={class:"flex items-center"},Re={class:"flex items-center"},Be={class:"w-[110px] truncate"},je=f(()=>a("span",{class:"flex ml-1 items-center justify-center rounded-[50%] bg-primary-400 text-xs text-white hover:bg-primary-600 min-h-[18px] min-w-[18px]"}," ✕ ",-1)),Ne=[je],Oe={class:"flex items-center"},Ue={class:"w-[110px] truncate"},Ve=f(()=>a("span",{class:"flex ml-1 items-center justify-center rounded-[50%] bg-primary-400 text-xs text-white hover:bg-primary-600 min-h-[18px] min-w-[18px]"}," ✕ ",-1)),ze=[Ve],Le={class:"w-[80%] mb-[140px]"},Ge={class:"flex items-center justify-center"},Je=Z({__name:"QAForm",props:{qaType:{type:String,default:"add"},editId:{type:String,default:""}},emits:["close","addOrEditQa"],setup(q,{emit:u}){const c=q,C=me(),{qaManagementInfo:h}=j(C),T=pe(),{createInfo:E}=j(T),V=ee({}),o=b("file"),p=b(!1),F=b("新增ＱＡ");switch(c.qaType){case"add":case"backAdd":F.value="新增ＱＡ";break;case"edit":case"backEdit":F.value="編輯ＱＡ";break;case"query":case"backQuery":F.value="查詢ＱＡ";break}const k=b("送審"),e=b({qaId:"",qaTitle:"",qaContent:"",status:"",publishStartAt:"",publishEndAt:"",qaFile:"",qaImage:"",qaHyperlink:"",isDefault:!0});function D(t){o.value=t}function z(t,l){const s=document.getElementById(t),i=document.getElementById(`upload-input${t}`);i==null||i.remove();const n=document.createElement("input");s==null||s.appendChild(n),n.id=`upload-input${t}`,n.style.display="none",n.type="file",n.accept=l,n.addEventListener("change",$=>{const A=$.target;if(!A||!A.files)return;const g=A.files[0];if(g.type==="application/pdf"||g.type==="image/png"){const v=g.type==="application/pdf"?"qaFile":"qaImage";e.value[v]=g.name}}),n.click()}function L(){switch(c.qaType){case"backEdit":const t=h.value.find(l=>l.qaId===c.editId);t&&(e.value.publishEndAt=t.publishEndAt,e.value.publishStartAt=t.publishStartAt,e.value.qaContent=t.qaContent,e.value.qaHyperlink=t.qaHyperlink,e.value.qaId=t.qaId,e.value.qaFile=t.qaFile,e.value.qaImage=t.qaImage,e.value.qaTitle=t.qaTitle,e.value.status=t.status);break}}function R(t){switch(t){case"file":e.value.qaFile="";break;case"image":e.value.qaImage="";break}}function G(){switch(c.qaType){case"query":console.log("前台查詢中"),k.value="確認";break;case"backQuery":console.log("後台查詢中");const t=h.value.find(l=>l.qaId===c.editId);t&&(e.value=t),p.value=!0,k.value="確認";break}}ae(()=>{switch(c.qaType){case"edit":t();break;case"query":t(),p.value=!0;break;case"backEdit":L();break;case"backQuery":G();break}function t(){k.value="確認";const l=E.value.selectedQA.findIndex(i=>i.qaId===c.editId),s=E.value.selectedQA[l];e.value.publishEndAt=s.publishEndAt,e.value.publishStartAt=s.publishStartAt,e.value.qaContent=s.qaContent,e.value.qaFile=s.qaFile,e.value.qaHyperlink=s.qaHyperlink,e.value.qaImage=s.qaImage,e.value.qaTitle=s.qaTitle}});function B(){u("close"),p.value=!1,k.value="送審"}function Q(t){const l=new Date(t),s=l.getFullYear(),i=(l.getMonth()+1).toString().padStart(2,"0"),n=l.getDate().toString().padStart(2,"0");return`${s}/${i}/${n}`}function J(t){const l=new Date,i={qaId:`${l.getFullYear()}/${String(l.getMonth()+1).padStart(2,"0")}/${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:${String(l.getMinutes()).padStart(2,"0")}:${String(l.getSeconds()).padStart(2,"0")}`,qaTitle:t.qaTitle,qaContent:t.qaContent,publishStartAt:Q(t.publishStartAt),publishEndAt:Q(t.publishEndAt),qaFile:e.value.qaFile,qaImage:e.value.qaImage,qaHyperlink:e.value.qaHyperlink};switch(c.qaType){case"add":const n={...i,expand:!1,newAdd:!0,isDefault:!1};u("addOrEditQa",n),u("close");break;case"backAdd":const $={...i,status:r.InReview,isDefault:!0};h.value.push($),u("close");break;case"edit":const A={...i,isDefault:!1};u("addOrEditQa",A),u("close");break;case"backEdit":console.log("後台編輯成功!");const g=h.value.findIndex(v=>v.qaId===e.value.qaId);if(g!==-1){const v=e.value;v.publishStartAt=Q(e.value.publishStartAt),v.publishEndAt=Q(e.value.publishEndAt),v.status=r.InReview,h.value[g]=v}u("close");break;case"query":u("close");break;case"backQuery":u("close")}}const Y=t=>{e.value.publishStartAt=t},W=t=>{e.value.publishEndAt=t};return(t,l)=>(te(),le(ie,{to:"body"},[d(se,{name:"modal"},{default:m(()=>[a("div",be,[a("div",fe,[d(ce,{title:F.value,onClose:B},null,8,["title"]),a("div",ve,[a("div",qe,[d(x(ne),{"validation-schema":x(V),"initial-values":e.value,onSubmit:l[6]||(l[6]=s=>J(s))},{default:m(()=>[a("div",he,[a("div",ge,[xe,a("div",_e,[d(x(S),{id:"publishStartAt",name:"publishStartAt"},{default:m(({field:s,errorMessage:i})=>[d(U,w(s,{placeholder:"請輸入日期",disabled:p.value,"error-message":i,class:"date-picker-input","onUpdate:modelValue":Y}),null,16,["disabled","error-message"])]),_:1}),ye,d(x(S),{id:"publishEndAt",name:"publishEndAt"},{default:m(({field:s,errorMessage:i})=>[d(U,w(s,{placeholder:"請輸入日期",disabled:p.value,"error-message":i,class:"date-picker-input","onUpdate:modelValue":W}),null,16,["disabled","error-message"])]),_:1})])]),a("div",Ie,[ke,d(x(S),{id:"qaTitle",name:"qaTitle"},{default:m(({field:s,value:i,errorMessage:n})=>[d(N,w(s,{placeholder:"請輸入問題",disabled:p.value,"model-value":e.value.qaTitle=i,"error-message":n}),null,16,["disabled","model-value","error-message"])]),_:1})]),a("div",Ae,[Se,d(x(S),{id:"qaContent",name:"qaContent"},{default:m(({field:s,value:i,errorMessage:n})=>[a("textarea",w({class:"h-[140px] rounded-md border border-gray-300 px-4 py-1 w-full focus:border-primary-500 focus:outline-0 focus:transition focus:duration-150 focus:ease-in disabled:bg-gray-200 disabled:text-[theme('colors.neutral.600')] disabled:border-gray-400"},s,{disabled:p.value,placeholder:"請輸入回答","model-value":e.value.qaContent=i,"error-message":n,class:{errorTextarea:!!n}}),null,16,we),a("div",Ce,_(n),1)]),_:1})]),a("div",Ee,[Fe,a("ul",Qe,[a("li",{class:H(["text-center grow pb-2 border-b-[5px] border-b-[transparent] cursor-pointer",{active:o.value==="file"}]),onClick:l[0]||(l[0]=s=>D("file"))}," 檔案 ",2),a("li",{class:H(["text-center grow pb-2 border-b-[5px] border-b-[transparent] cursor-pointer",{active:o.value==="image"}]),onClick:l[1]||(l[1]=s=>D("image"))}," 圖片 ",2),a("li",{class:H(["text-center grow pb-2 border-b-[5px] border-b-[transparent] cursor-pointer",{active:o.value==="url"}]),onClick:l[2]||(l[2]=s=>D("url"))}," 網址 ",2)]),a("div",Te,[y(a("div",{id:o.value==="file"?"file-pdf":"file-image",class:"w-full h-[100%] cursor-pointer text-center flex flex-col items-center justify-center"},[$e,He,a("p",Me,_(o.value==="file"?"限上傳PDF檔":"限上傳JPG檔或PNG檔"),1),d(M,{id:"UploadFile",type:"button",size:"m",class:"my-2",accept:o.value==="file"?"application/pdf":"image/png",disabled:o.value==="file"?e.value.qaFile!=="":e.value.qaImage!=="",onClick:l[3]||(l[3]=s=>z(o.value==="file"?"file-pdf":"file-image",o.value==="file"?"application/pdf":"image/png"))},{default:m(()=>[P(_(o.value==="file"?e.value.qaFile!==""?"已上傳":"上傳檔案":e.value.qaImage!==""?"已上傳":"上傳圖片"),1)]),_:1},8,["accept","disabled"]),a("div",Pe,[y(a("span",Re,[a("span",Be,_(e.value.qaFile),1),y(a("button",{type:"button",onClick:l[4]||(l[4]=O(s=>R("file"),["stop"]))},Ne,512),[[I,e.value.qaFile&&p.value===!1]])],512),[[I,o.value==="file"]]),y(a("span",Oe,[a("span",Ue,_(e.value.qaImage),1),y(a("button",{type:"button",onClick:l[5]||(l[5]=O(s=>R("image"),["stop"]))},ze,512),[[I,e.value.qaImage&&p.value===!1]])],512),[[I,o.value==="image"]])])],8,De),[[I,o.value==="file"||o.value==="image"]]),y(a("div",Le,[d(x(S),{name:"qaHyperlink"},{default:m(({field:s,value:i,errorMessage:n})=>[d(N,w(s,{placeholder:"請輸入URL","model-value":e.value.qaHyperlink=i,"error-message":n,disabled:p.value}),null,16,["model-value","error-message","disabled"])]),_:1})],512),[[I,o.value==="url"]])])]),a("div",Ge,[d(M,{outline:!0,class:"font-semibold mr-2",size:"custom",width:250,height:48,onClick:B},{default:m(()=>[P(" 取消 ")]),_:1}),d(M,{class:"font-semibold",type:"submit",size:"custom",width:250,height:48},{default:m(()=>[P(_(k.value),1)]),_:1})])])]),_:1},8,["validation-schema","initial-values"])])])])])]),_:1})]))}});const aa=re(Je,[["__scopeId","data-v-43194a0d"]]);export{aa as Q,me as u};
