import{a3 as U,r as d,y,d as J,J as H,W,g as K,o as M,p as X,b as i,w as m,T as Z,a9 as ee,a as s,u as p,a2 as ae,l as I,m as k,L as C,n as ne,i as E,a4 as T,h as S,t as B,c as te,e as se,v as le,k as re}from"./index-72eb97a3.js";import{_ as ie}from"./icon_upload-consent-letter-8322da82.js";import{_ as ue}from"./FormTitle.vue_vue_type_script_setup_true_lang-3ddf6d71.js";import{_ as z}from"./InputDate.vue_vue_type_style_index_0_lang-16a23bdb.js";import{I as u,u as de}from"./createPageStore-5e2e62fe.js";import{h as P}from"./moment-fbc5633a.js";const oe=U("banner",()=>{const g=d("revie"),b=d({searchStartTime:"",searchEndTime:""}),o=d([{bannerId:"",bannerName:"",bannerHyperlink:"",status:"",publishStartAt:"",publishEndAt:"",bannerImage:{},isDefault:!0}]),h=d([{bannerId:"1101712995994",bannerName:"Banner 名稱A",bannerHyperlink:"url.example1.com",status:u.Published,publishStartAt:"2023/08/17",publishEndAt:"2023/09/17",bannerImage:{name:"example1.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"1601512995985",bannerName:"Banner 名稱B",bannerHyperlink:"url.example2.com",status:u.InReview,publishStartAt:"2023/08/21",publishEndAt:"2023/08/28",bannerImage:{name:"example2.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"8701632992981",bannerName:"Banner 名稱C",bannerHyperlink:"url.example3.com",status:u.InReview,publishStartAt:"2023/08/20",publishEndAt:"2023/09/07",bannerImage:{name:"example3.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"3751412295581",bannerName:"Banner 名稱D",bannerHyperlink:"url.example4.com",status:u.Awaiting,publishStartAt:"2023/11/29",publishEndAt:"2023/12/30",bannerImage:{name:"example4.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"55014125499184",bannerName:"Banner 名稱E",bannerHyperlink:"url.example5.com",status:u.Suspended,publishStartAt:"2023/09/20",publishEndAt:"2023/10/10",bannerImage:{name:"example5.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"9721612885993",bannerName:"Banner 名稱F",bannerHyperlink:"url.example6.com",status:u.InReview,publishStartAt:"2023/11/11",publishEndAt:"2023/12/11",bannerImage:{name:"example6.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"3301222995580",bannerName:"Banner 名稱G",bannerHyperlink:"url.example7.com",status:u.Failure,publishStartAt:"2023/10/10",publishEndAt:"2023/11/11",bannerImage:{name:"example7.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"1221712995001",bannerName:"Banner 名稱H",bannerHyperlink:"url.example8.com",status:u.Published,publishStartAt:"2023/08/18",publishEndAt:"2023/09/18",bannerImage:{name:"example8.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0},{bannerId:"1331712995335",bannerName:"Banner 名稱I",bannerHyperlink:"url.example9.com",status:u.Published,publishStartAt:"2023/08/19",publishEndAt:"2023/09/19",bannerImage:{name:"example9.png",size:1024,type:"image/png",lastModified:16250724e5},isDefault:!0}]),v=y(()=>h.value.filter(f=>f.status===u.Published)),A=d({published:{isChecked:!1,value:"發佈中"},pending:{isChecked:!1,value:"等待發佈"},discontinued:{isChecked:!1,value:"下架"},reviewing:{isChecked:!1,value:"審核中"},reviewFailed:{isChecked:!1,value:"審核失敗"}});return{permissionStatus:g,bannerManagementInfo:h,sortOrderData:v,checkBoxState:A,filterBannerData:o,filterSelectDate:b}}),me={class:"modal-mask banner-form"},be={class:"content"},ce={class:"w-[80%] py-4 gap-6 mx-auto grid grid-cols-1"},pe=s("h2",{class:"label-h2"}," 發佈時間 ",-1),ge={class:"flex items-center"},he=s("span",{class:"mx-2"},"-",-1),ve=s("h2",{class:"label-h2"}," 圖片名稱 ",-1),fe=s("h2",{class:"label-h2"}," 超連結 ",-1),Ie=s("h2",{class:"label-h2"}," 圖片上傳 ",-1),ke=s("img",{src:ie,alt:"image-upload",class:"mb-2"},null,-1),ye=s("p",{class:"text-lg"}," 請上傳圖片 ",-1),Ae=s("p",{class:"text-sm text-black/50 mb-4"}," 限上傳PNG檔或JPG檔 ",-1),xe={class:"min-h-[24px]"},_e={key:0,class:"flex items-center"},Ee={class:"inline-block w-[110px] truncate"},Se={class:"flex items-center justify-center py-6"},Ce=J({__name:"BannerForm",props:{bannerType:{type:String,default:"add"},editId:{type:String,default:""}},emits:["close","addOrEditBanner"],setup(g,{emit:b}){const o=g;d(!1),d(null);const h=de(),{createInfo:v}=H(h),A=oe(),{bannerManagementInfo:f}=H(A),$=y(()=>o.editId),c=d(!1),e=d({bannerId:"",bannerName:"",bannerHyperlink:"",status:"",publishStartAt:"",publishEndAt:"",bannerImage:{},bannerImageName:"",isDefault:!1,expand:!1}),F=y(()=>{switch(o.bannerType){case"add":case"backAdd":default:return"新增banner";case"edit":case"backEdit":return"編輯Banner";case"query":case"backQuery":return"查看Banner"}}),V=y(()=>{switch(o.bannerType){case"add":case"edit":case"query":case"backQuery":default:return"確認";case"backAdd":case"backEdit":return"送審"}}),N=d(),Y=W({});K(()=>{function l(){const n=v.value.selectedBanner.findIndex(r=>r.bannerId===$.value),a=v.value.selectedBanner[n];e.value.publishStartAt=a.publishStartAt,e.value.publishEndAt=a.publishEndAt,e.value.bannerName=a.bannerName,e.value.bannerHyperlink=a.bannerHyperlink,e.value.bannerImage=a.bannerImage,e.value.bannerImageName=a.bannerImageName,N.value=a.bannerImage}function t(){const n=f.value.findIndex(r=>r.bannerId===o.editId),a=f.value[n];e.value.bannerId=a.bannerId,e.value.bannerName=a.bannerName,e.value.bannerHyperlink=a.bannerHyperlink,e.value.status=a.status,e.value.publishStartAt=a.publishStartAt,e.value.publishEndAt=a.publishEndAt,e.value.bannerImage={...a.bannerImage},e.value.isDefault=a.isDefault,e.value.bannerImageName=a.bannerImage.name}switch(o.bannerType){case"edit":l();break;case"query":l(),c.value=!0;break;case"backEdit":t();break;case"backQuery":t(),c.value=!0;break}});function j(){return o.bannerType==="edit"||o.bannerType==="backEdit"||(e.value.publishStartAt=P().format("YYYY/MM/DD")),e.value.publishStartAt}const R=()=>{const l=document.getElementById("uploadButton");l==null||l.click()};function Q(l){const t=document.getElementById(l),n=document.getElementById(`upload-input${l}`);n==null||n.remove();const a=document.createElement("input");t==null||t.appendChild(a),a.id=`upload-input${l}`,a.style.display="none",a.type="file",a.accept="image/png,image/jpeg",a.addEventListener("change",r=>{L(r,l)}),a.addEventListener("click",function(r){r.stopPropagation()}),a.click()}function L(l,t){const n=l.target.files[0],a=document.getElementById(`upload-input${t}`);e.value.bannerImage=n,e.value.bannerImageName=n.name,a==null||a.remove()}function O(l){const t=document.getElementById(`upload-input${l}`);t==null||t.remove(),e.value.bannerImageName=""}function D(l,t){e.value[t]=P(l).format("YYYY/MM/DD")}function q(l,t){const n={bannerId:Date.now().toString(),bannerName:l.bannerName,bannerHyperlink:l.bannerHyperlink,publishStartAt:e.value.publishStartAt,publishEndAt:e.value.publishEndAt},a={bannerImage:e.value.bannerImage,bannerImageChange:!0};switch(t){case"add":const r={...n,bannerImage:e.value.bannerImage,bannerImageName:e.value.bannerImageName,expand:!1,newAdd:!0,isDefault:!1};b("addOrEditBanner",r);break;case"backAdd":const G={...n,bannerImage:e.value.bannerImage,status:u.InReview,isDefault:!0};b("addOrEditBanner",G,"backAdd");break;case"edit":let _;N.value===e.value.bannerImage?_={...n}:_={...n,...a},b("addOrEditBanner",_);break;case"backEdit":const w={...n,bannerId:e.value.bannerId,status:u.InReview,isDefault:!0};console.log("編輯送出資料"),console.log(w),b("addOrEditBanner",w,"backEdit");break}x()}function x(){b("close")}return(l,t)=>(M(),X(ee,{to:"body"},[i(Z,{name:"modal"},{default:m(()=>[s("div",me,[s("div",be,[i(ue,{title:F.value,onClose:x},null,8,["title"]),i(p(ae),{"validation-schema":p(Y),"initial-values":e.value,onSubmit:t[4]||(t[4]=n=>q(n,g.bannerType))},{default:m(()=>[s("div",ce,[s("div",null,[pe,s("div",ge,[i(p(I),{name:"publishStartAt"},{default:m(({field:n,errorMessage:a})=>[i(z,k(n,{value:j(),placeholder:"請選擇日期",disabled:c.value,"error-message":a,"onUpdate:modelValue":t[0]||(t[0]=r=>D(r,"publishStartAt"))}),null,16,["value","disabled","error-message"])]),_:1}),he,i(p(I),{name:"publishEndAt"},{default:m(({field:n,errorMessage:a})=>[i(z,k(n,{value:e.value.publishEndAt,placeholder:"請選擇日期",disabled:c.value,"error-message":a,"onUpdate:modelValue":t[1]||(t[1]=r=>D(r,"publishEndAt"))}),null,16,["value","disabled","error-message"])]),_:1})])]),s("div",null,[ve,i(p(I),{name:"bannerName"},{default:m(({field:n,value:a,errorMessage:r})=>[i(C,k(n,{placeholder:"素材.jpg",disabled:c.value,"model-value":e.value.bannerName=a,"error-message":r}),null,16,["placeholder","disabled","model-value","error-message"])]),_:1})]),s("div",null,[fe,i(p(I),{name:"bannerHyperlink"},{default:m(({field:n,value:a,errorMessage:r})=>[i(C,k(n,{placeholder:"http://aaaas.jpg",disabled:c.value,"model-value":e.value.bannerHyperlink=a,"error-message":r}),null,16,["placeholder","disabled","model-value","error-message"])]),_:1})]),s("div",null,[s("div",null,[Ie,s("div",{id:"uploadImage",class:ne(["flex flex-col justify-center items-center border border-dashed border-black/30 rounded-md p-10 pb-6 min-h-[263px]",{"cursor-pointer":e.value.bannerImageName===""}]),onClick:R},[ke,ye,Ae,i(E,{id:"uploadButton",size:"m",disabled:e.value.bannerImageName!=="",class:"mb-4",onClick:t[2]||(t[2]=T(n=>Q("uploadImage"),["stop"]))},{default:m(()=>[S(B(e.value.bannerImageName!==""?"已上傳":"上傳檔案"),1)]),_:1},8,["disabled"]),s("div",xe,[e.value.bannerImageName!==""?(M(),te("div",_e,[s("span",Ee,B(e.value.bannerImageName),1),se(s("span",{class:"cursor-pointer flex items-center justify-center rounded-full bg-primary-400 text-xs text-white hover:bg-primary-600 min-h-[18px] min-w-[18px]",onClick:t[3]||(t[3]=T(n=>O("uploadImage"),["stop"]))},"✕ ",512),[[le,e.value.bannerImageName!==""&&!c.value]])])):re("",!0)])],2)])])]),s("div",Se,[i(E,{size:"custom",width:250,height:48,outline:!0,class:"mr-4",onClick:x},{default:m(()=>[S(" 取消 ")]),_:1}),i(E,{size:"custom",type:"submit",width:250,height:48},{default:m(()=>[S(B(V.value),1)]),_:1})])]),_:1},8,["validation-schema","initial-values"])])])]),_:1})]))}});export{Ce as _,oe as u};
